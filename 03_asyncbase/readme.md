# Асинхронность в JavaScript: коллбеки, промисы, async/await

Это учебный файл с примерами разных способов работы с асинхронным кодом в JavaScript.  
Он объединяет практику из фронтенда (fetch) и Node.js (fs).

---

## Содержание примера

1. **Коллбеки**  
   - `sum(a, b, cb)` — классический пример callback-функции.  
   - Минусы: плохо читается при вложенности, сложно обрабатывать ошибки.

2. **Промисы**  
   - `sumPromise(a, b)` — обёртка над задачей с использованием `new Promise`.  
   - Дает `.then()` и `.catch()`, упрощает цепочки.  
   - Ошибки обрабатываются через `reject`.

3. **Работа с `fetch`**  
   - Вариант с `.then()`  
   - Вариант с `async/await` (синтаксический сахар).  
   - Подводный камень: `fetch` не кидает исключение при `404/500`, только при сетевой ошибке. Нужно проверять `response.ok`.

4. **`Promise.all` и параллельные задачи**  
   - Одновременные запросы (`getPosts`, `getUsers`).  
   - Работает быстрее, чем последовательное выполнение.  
   - Подводный камень: если один промис упадет → весь `Promise.all` завершится с ошибкой.  
   - Альтернатива: `Promise.allSettled`.

5. **Создание собственных промисов**  
   - Демонстрация работы `resolve` и `reject`.  
   - Важно:  
     - Вызываются только один раз.  
     - Если не вызвать ни один → промис «зависнет».  

6. **Работа с файлами в Node.js**  
   - Оборачивание `fs.readFile` в промис (`readFromFile`).  
   - Использование через `.then()` и через `async/await`.  
   - Подводный камень:  
     - Ошибки чтения (`ENOENT`, нет доступа) уходят в `catch`.  
     - В Node.js есть встроенный `fs.promises`, который упрощает запись.

---

## Основные выводы

- **Коллбеки** — устаревший, но важный для понимания подход.  
- **Промисы** — современный стандарт, удобнее для построения цепочек.  
- **async/await** — синтаксический сахар над промисами, делает код «похожим на синхронный».  
- **Обработка ошибок**:  
  - всегда используем `.catch()` или `try/catch`.  
  - нельзя полагаться только на успешное выполнение.  
- **Promise.all** — мощный инструмент, но требует внимательности к ошибкам.  
- **Node.js (fs)** — коллбековый API часто нужно оборачивать в промисы.  

---

## Подводные камни

- `fetch` не кидает исключение при статусах 404/500.  
- Промис можно зарезолвить/зареджектить только один раз.  
- Забытая обработка ошибок может «уронить» процесс.  
- В `Promise.all` ошибка одного промиса ломает всё.  

---

## Сахар

- `async/await` — удобный синтаксис для работы с промисами.  
- `.then().catch()` и `try/catch` делают одно и то же, вопрос только в читаемости.  
- `fs.promises.readFile` — упрощённая альтернатива ручной обёртки в промис.  
